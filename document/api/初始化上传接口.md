## 一、初始化上传接口的商业化目标

* 这不是一个“生成 URL 的接口”，而是一个 上传准入控制中心：
    * 控制 谁 能上传
    * 控制 上传什么
    * 控制 上传到哪里
    * 控制 多大 / 多频率
    * 控制 未来如何扩展（分片 / 转码 / 审核）

## 二、接口设计（稳定可演进）

### 接口定义

* POST /api/v1/files/upload/init

* Request（客户端 → 服务端）

```json
{
  "fileName": "course-intro.mp4",
  "fileSize": 104857600,
  "contentType": "video/mp4",
  "bizType": "course_video",
  "checksum": "md5-or-sha1-optional"
}
```

* Response（服务端 → 客户端）

```json
{
  "uploadId": "upl_8d93a0b4c2",
  "uploadUrl": "https://ocs.xxx.com/...",
  "objectKey": "course_video/2025/01/uuid.mp4",
  "expireAt": 1700000000,
  "uploadMode": "DIRECT"
}
```

### 设计说明（商业级）

| 字段	        | 为什么要          |
|------------|---------------|
| uploadId   | 	幂等、状态追踪、风控   |
| bizType    | 	决定目录、权限、后处理  |
| checksum   | 	秒传 / 去重 / 合规 |
| expireAt   | 	防滥用          |
| uploadMode | 	后期支持 CHUNK   |

## 三、初始化上传接口必须做的校验（重点）

* 商业系统必须有这些校验

| 校验      | 目的    |
|---------|-------|
| 登录态     | 谁在上传  |
| 文件大小    | 防止炸存储 |
| 文件类型    | 防违规   |
| bizType | 防越权   |
| 频率      | 防刷    |
| 幂等      | 防重复   | 